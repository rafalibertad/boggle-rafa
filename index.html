<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Boggle</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            height: 100vh;   /* fallback */
            height: 100dvh;  /* viewport din√°mico real */
            width: 100vw;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        .container {
            position: fixed;
            inset: 0;
            display: grid;
            place-items: center;
            height: 100vh;
            height: 100dvh;
        }
        
        h1 {
            color: white;
            font-size: clamp(24px, 5vw, 32px);
            text-align: center;
            padding: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            flex-shrink: 0;
        }

        .grid {
            /* margen real respecto a los bordes f√≠sicos del tel√©fono */
            --edge: 10px;
        
            width: min(
                calc(100vw - (var(--edge) * 2)),
                calc(100dvh - (var(--edge) * 2))
            );
        
            height: min(
                calc(100vw - (var(--edge) * 2)),
                calc(100dvh - (var(--edge) * 2))
            );
        
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        
            gap: clamp(6px, 1.6vmin, 12px);
            padding: clamp(8px, 2vmin, 16px);
        
            box-sizing: border-box;

            background: rgba(0,0,0,0.18);
            border-radius: 22px;
            box-shadow: inset 0 0 18px rgba(0,0,0,0.45);
        }
        
        
        .die {
            aspect-ratio: 1;
            background: rgba(255,255,255,0.95);
            border-radius: 15%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(42px, 18vw, 65px);
            font-weight: 950;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            user-select: none;
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255,255,255,0.3);
        }
        
        .die:hover:not(:disabled) { 
            transform: scale(1.08); 
            box-shadow: 0 15px 45px rgba(0,0,0,0.6);
        }
        
        .die.shaking { 
            animation: shake 0.6s cubic-bezier(0.36, 0.07, 0.19, 0.97) both; 
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px) rotate(-2deg); }
            20%, 40%, 60%, 80% { transform: translateX(3px) rotate(2deg); }
        }
        
        .controls {
            position: fixed;
            bottom: calc(env(safe-area-inset-bottom) + 12px);
            left: 50%;
            transform: translateX(-50%);
        
            display: flex;
            gap: 12px;
            padding: 12px 14px;

            width: min(92vw, 520px);
            justify-content: space-between;
            
            background: rgba(0,0,0,0.28);
            backdrop-filter: blur(20px);
            border-radius: 28px;
        
            z-index: 1000;
        }

        
        button {
            flex: 1;
            padding: 18px 8px;
            font-size: clamp(16px, 4vw, 20px);
            border: none;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            max-width: none;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        #shuffleBtn { background: linear-gradient(145deg, #4CAF50, #45a049); }
        #shuffleBtn:hover:not(:disabled) { transform: translateY(-2px); }
        #shuffleBtn:active:not(:disabled) { transform: translateY(0); }
        #shuffleBtn:disabled { background: #666; cursor: not-allowed; transform: none; }
        
        #timerBtn { background: linear-gradient(145deg, #FF9800, #e68900); }
        #timerBtn.running { background: linear-gradient(145deg, #2196F3, #1976D2); }
        #timerBtn:hover:not(:disabled) { transform: translateY(-2px); }
        #timerBtn:disabled { background: #666; cursor: not-allowed; transform: none; }
        
        #resetBtn { background: linear-gradient(145deg, #9C27B0, #7B1FA2); }
        #resetBtn:hover:not(:disabled) { transform: translateY(-2px); }
        #resetBtn:disabled { background: #666; cursor: not-allowed; transform: none; }
        
        #timer {
            position: fixed;
            top: calc(env(safe-area-inset-top) + 10px);
            left: 50%;
            transform: translateX(-50%);
        
            font-size: clamp(36px, 9vw, 64px);
            font-weight: 900;
            color: rgba(255,255,255,0.95);
        
            text-shadow: 0 4px 18px rgba(0,0,0,0.75);
            z-index: 1000;
        }
        
        .time-up {
            color: #ff4444 !important;
            text-shadow: 0 0 25px #ff4444, 0 0 40px #ff4444;
            animation: pulse 0.8s infinite;
            filter: drop-shadow(0 0 15px #ff4444);
        }

        /* === SCORE MODAL === */
        
        .score-modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.55);
            backdrop-filter: blur(8px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 500;
        }
        
        .score-modal.show {
            display: flex;
            animation: fadeIn 0.25s ease;
        }
        
        .score-panel {
            background: rgba(255,255,255,0.97);
            border-radius: 22px;
            padding: 20px;
            width: min(90vw, 380px);
            box-shadow: 0 20px 60px rgba(0,0,0,0.6);
            animation: pop 0.25s cubic-bezier(.2,.8,.2,1);
        }
        
        .score-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 22px;
            font-weight: 800;
            margin-bottom: 14px;
        }
        
        #closeScore {
            background: #ff4d4d;
            border: none;
            color: white;
            border-radius: 50%;
            width: 34px;
            height: 34px;
            font-size: 18px;
            cursor: pointer;
        }
        
        .score-table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
            font-size: 20px;
        }
        
        .score-table th {
            padding: 8px;
            background: #764ba2;
            color: white;
        }
        
        .score-table td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            font-weight: 700;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes pop {
            from { transform: scale(.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
           
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.12); }
        }
        
        @media (orientation: landscape) {
            .grid { gap: 1vw; padding: 1vw; }
            .controls { padding: 12px 15px; }
        }

        @media (max-width: 768px) { /* iPhone */
            .grid {
                gap: 4px !important; /* Espacios TIGHT en iPhone */
                padding: 8px !important;
            }
            .controls {
                gap: 8px;
                padding: 10px;
            }
            button {
                padding: 12px 4px;
                font-size: 16px;
                min-height: 48px; /* Touch target iOS */
            }
        }

        @media (max-width: 414px) { /* iPhone peque√±o */
            .die {
                font-size: clamp(24px, 16vw, 38px);
                border-radius: 12%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="grid" id="diceGrid"></div>
        <div class="controls">
            <button id="shuffleBtn">üé≤</button>
            <button id="timerBtn">‚è±Ô∏è</button>
            <button id="resetBtn" disabled>üîÑ</button>
            <button id="scoreBtn">üìñ</button>
        </div>
    </div>
    
    <div id="timer">00:00</div>
    
    <div id="scoreModal" class="score-modal">
        <div class="score-panel">
            <div class="score-header">
                <span>üìñ Puntaje</span>
            </div>
    
            <table class="score-table">
                <tr><th>Letras</th><th>Puntos</th></tr>
                <tr><td>3 - 4</td><td>1</td></tr>
                <tr><td>5</td><td>2</td></tr>
                <tr><td>6</td><td>3</td></tr>
                <tr><td>7</td><td>5</td></tr>
                <tr><td>8 o m√°s</td><td>11</td></tr>
            </table>
        </div>
    </div>
    
    <script>
        const dieFaces = [
            ['A','A','E','E','O','O'],
            ['A','E','I','O','U','S'],
            ['A','R','E','S','T','N'],
            ['A','L','E','R','S','T'],
            ['E','I','O','S','N','R'],
            ['E','I','N','S','T','U'],
            ['O','R','A','L','E','S'],
            ['I','D','E','L','R','T'],
            ['C','A','R','E','S','T'],
            ['C','O','M','P','A','S'],
            ['D','E','L','A','R','O'],
            ['M','A','N','T','E','S'],
            ['P','L','A','R','E','O'],
            ['T','U','R','A','L','E'],
            ['B','G','V','Y','H','F'],
            ['J','√ë','X','Z','Qu','U']
        ];

        class BoggleGame {
            constructor() {
                this.diceGrid = [];
                this.timer = 0;
                this.maxTime = 120;
                this.timerInterval = null;
                this.isTimerRunning = false;
                this.isTimeUp = false;
                this.init();
            }

            init() {
                this.createGrid();
                this.updateTimerDisplay();
                this.bindEvents();
            }

            createGrid() {
                const grid = document.getElementById('diceGrid');
                grid.innerHTML = '';
                this.diceGrid = [];
                
                for (let i = 0; i < 16; i++) {
                    const die = document.createElement('div');
                    die.className = 'die';
                    die.dataset.index = i;
                    die.textContent = this.getRandomFace(i);
                    this.diceGrid.push(die);
                    grid.appendChild(die);
                }
            }

            getRandomFace(index) {
                const faces = dieFaces[index % dieFaces.length];
                let letter = faces[Math.floor(Math.random() * 6)];
    
                return letter;
            }

            
            shuffle() {
                if (this.isTimeUp) return;
                
                const diceData = this.diceGrid.map((die, index) => ({
                    element: die,
                    index: index,
                    face: die.textContent
                }));
                
                // Barajar posiciones
                for (let i = diceData.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [diceData[i], diceData[j]] = [diceData[j], diceData[i]];
                }
                
                const grid = document.getElementById('diceGrid');
                grid.innerHTML = '';
                this.diceGrid = [];
                
                diceData.forEach((data, newIndex) => {
                    const newDie = document.createElement('div');
                    newDie.className = 'die';
                    newDie.dataset.index = newIndex;
                    const originalFaces = dieFaces[data.index % dieFaces.length];
                    newDie.textContent = originalFaces[Math.floor(Math.random() * 6)];
                    
                    newDie.classList.add('shaking');
                    this.diceGrid.push(newDie);
                    grid.appendChild(newDie);
                    
                    setTimeout(() => newDie.classList.remove('shaking'), 600);
                });
            }

            startTimerInterval() {
                this.timerInterval = setInterval(() => {
                    this.timer++;
                    this.updateTimerDisplay();
                    if (this.timer >= this.maxTime) this.timeUp();
                }, 1000);
            }

            toggleTimer() {
                if (this.isTimeUp) return;
                
                if (!this.isTimerRunning) {
                    this.isTimerRunning = true;
                    document.getElementById('timerBtn').textContent = '‚èπÔ∏è';
                    document.getElementById('timerBtn').classList.add('running');
                    document.getElementById('resetBtn').disabled = false;
                    this.startTimerInterval();
                } else {
                    this.isTimerRunning = false;
                    document.getElementById('timerBtn').textContent = '‚ñ∂Ô∏è';
                    document.getElementById('timerBtn').classList.remove('running');
                    clearInterval(this.timerInterval);
                }
            }

            resetTimer() {
                if (this.timerInterval) clearInterval(this.timerInterval);
                this.timer = 0;
                this.isTimerRunning = false;
                this.isTimeUp = false;
                
                document.getElementById('timerBtn').textContent = '‚è±Ô∏è';
                document.getElementById('timerBtn').classList.remove('running');
                document.getElementById('shuffleBtn').disabled = false;
                document.getElementById('resetBtn').disabled = true;
                document.getElementById('timer').classList.remove('time-up');
                document.getElementById('timerBtn').disabled = false;
                
                this.updateTimerDisplay();
            }

            timeUp() {
                this.isTimerRunning = false;
                this.isTimeUp = true;
                clearInterval(this.timerInterval);
           
                document.getElementById('timer').classList.add('time-up');
                document.getElementById('shuffleBtn').disabled = true;
                document.getElementById('timerBtn').disabled = true;
                document.getElementById('timerBtn').textContent = '‚è±Ô∏è';
                document.getElementById('resetBtn').disabled = false;
            }

            updateTimerDisplay() {
                const minutes = Math.floor(this.timer / 60);
                const seconds = this.timer % 60;
                document.getElementById('timer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }

            bindEvents() {
                document.getElementById('shuffleBtn').onclick = () => this.shuffle();
                document.getElementById('timerBtn').onclick = () => this.toggleTimer();
                document.getElementById('resetBtn').onclick = () => this.resetTimer();

                // Puntaje modal
                document.getElementById('scoreBtn').onclick = () => {
                    document.getElementById('scoreModal').classList.add('show');
                };
                                
                // cerrar tocando afuera
                document.getElementById('scoreModal').onclick = (e) => {
                    if (e.target.id === 'scoreModal') {
                        document.getElementById('scoreModal').classList.remove('show');
                    }
                };

            }
        }

        new BoggleGame();
    </script>
</body>
</html>
